# æ¶æ„è¯´æ˜

[English](ARCHITECTURE.md) | ç®€ä½“ä¸­æ–‡

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»AI Team MCPçš„ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡ç†å¿µã€‚

---

## ğŸ“ ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

AI Team MCPé‡‡ç”¨100%æ¨¡å—åŒ–æ¶æ„ï¼Œä»åŸå§‹çš„2700+è¡Œå•ä½“æ–‡ä»¶é‡æ„ä¸º17ä¸ªæ¸…æ™°çš„æ¨¡å—ã€‚

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **å•ä¸€èŒè´£** - æ¯ä¸ªæ¨¡å—ä¸“æ³¨äºä¸€ä¸ªç‰¹å®šåŠŸèƒ½
2. **ä½è€¦åˆ** - æ¨¡å—ä¹‹é—´ä¾èµ–æœ€å°åŒ–
3. **é«˜å†…èš** - ç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨åŒä¸€æ¨¡å—
4. **æ˜“æ‰©å±•** - æ·»åŠ æ–°åŠŸèƒ½æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
5. **æ˜“ç»´æŠ¤** - æœ€å¤§æ–‡ä»¶ä¸è¶…è¿‡820è¡Œä»£ç 

---

## ğŸ—ï¸ æ¨¡å—ç»“æ„

```
mcp_ai_chat/
â”œâ”€â”€ server_modular.py           # ğŸšª ä¸»å…¥å£ (æ–°ç‰ˆ)
â”‚   â””â”€â”€ èŒè´£: å¯åŠ¨MCPæœåŠ¡å™¨ï¼Œæ³¨å†Œæ‰€æœ‰å·¥å…·
â”‚
â”œâ”€â”€ server.py                   # ğŸ“¦ æ—§ç‰ˆæœåŠ¡å™¨ (å‘åå…¼å®¹)
â”‚   â””â”€â”€ èŒè´£: å•ä½“æ¶æ„æœåŠ¡å™¨ï¼Œä¿æŒå…¼å®¹æ€§
â”‚
â”œâ”€â”€ config.py                   # âš™ï¸ é…ç½®ç®¡ç†
â”‚   â””â”€â”€ èŒè´£: ç®¡ç†å…¨å±€é…ç½®å’Œå¸¸é‡
â”‚
â”œâ”€â”€ tools/                      # ğŸ”§ å·¥å…·å®šä¹‰å±‚ (28ä¸ªå·¥å…·)
â”‚   â”œâ”€â”€ __init__.py            # å·¥å…·å¯¼å‡º
â”‚   â”œâ”€â”€ message_tools.py       # æ¶ˆæ¯å·¥å…· (8ä¸ª)
â”‚   â”‚   â”œâ”€â”€ send_message
â”‚   â”‚   â”œâ”€â”€ receive_messages
â”‚   â”‚   â”œâ”€â”€ mark_messages_read
â”‚   â”‚   â”œâ”€â”€ request_help
â”‚   â”‚   â”œâ”€â”€ request_review
â”‚   â”‚   â”œâ”€â”€ notify_completion
â”‚   â”‚   â””â”€â”€ share_code_snippet
â”‚   â”‚
â”‚   â”œâ”€â”€ task_tools.py          # ä»»åŠ¡å·¥å…· (5ä¸ª)
â”‚   â”‚   â”œâ”€â”€ create_task
â”‚   â”‚   â”œâ”€â”€ assign_task
â”‚   â”‚   â”œâ”€â”€ update_task_status
â”‚   â”‚   â”œâ”€â”€ get_tasks
â”‚   â”‚   â””â”€â”€ delete_task
â”‚   â”‚
â”‚   â”œâ”€â”€ group_tools.py         # ç¾¤ç»„å·¥å…· (10ä¸ª)
â”‚   â”‚   â”œâ”€â”€ create_group
â”‚   â”‚   â”œâ”€â”€ send_group_message
â”‚   â”‚   â”œâ”€â”€ receive_group_messages
â”‚   â”‚   â”œâ”€â”€ list_groups
â”‚   â”‚   â”œâ”€â”€ join_group
â”‚   â”‚   â”œâ”€â”€ leave_group
â”‚   â”‚   â”œâ”€â”€ summarize_group_messages
â”‚   â”‚   â”œâ”€â”€ get_unread_counts
â”‚   â”‚   â”œâ”€â”€ archive_group
â”‚   â”‚   â”œâ”€â”€ pin_message
â”‚   â”‚   â””â”€â”€ unpin_message
â”‚   â”‚
â”‚   â””â”€â”€ system_tools.py        # ç³»ç»Ÿå·¥å…· (5ä¸ª)
â”‚       â”œâ”€â”€ register_agent
â”‚       â”œâ”€â”€ get_current_session
â”‚       â”œâ”€â”€ list_agents
â”‚       â”œâ”€â”€ set_employee_config
â”‚       â””â”€â”€ standby
â”‚
â”œâ”€â”€ handlers/                   # ğŸ¯ ä¸šåŠ¡é€»è¾‘å±‚ (4ä¸ªå¤„ç†å™¨)
â”‚   â”œâ”€â”€ __init__.py            # å¤„ç†å™¨å¯¼å‡º
â”‚   â”œâ”€â”€ message_handler.py     # æ¶ˆæ¯å¤„ç†é€»è¾‘
â”‚   â”‚   â””â”€â”€ èŒè´£: æ¶ˆæ¯å‘é€ã€æ¥æ”¶ã€å·²è¯»çŠ¶æ€ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ task_handler.py        # ä»»åŠ¡å¤„ç†é€»è¾‘
â”‚   â”‚   â””â”€â”€ èŒè´£: ä»»åŠ¡CRUDã€çŠ¶æ€ç®¡ç†ã€æƒé™æ§åˆ¶
â”‚   â”‚
â”‚   â”œâ”€â”€ group_handler.py       # ç¾¤ç»„å¤„ç†é€»è¾‘
â”‚   â”‚   â””â”€â”€ èŒè´£: ç¾¤ç»„ç®¡ç†ã€ç¾¤ç»„æ¶ˆæ¯ã€æˆå‘˜ç®¡ç†
â”‚   â”‚
â”‚   â””â”€â”€ system_handler.py      # ç³»ç»Ÿå¤„ç†é€»è¾‘
â”‚       â””â”€â”€ èŒè´£: ä»£ç†æ³¨å†Œã€ä¼šè¯ç®¡ç†ã€å¾…å‘½æ¨¡å¼
â”‚
â”œâ”€â”€ core/                       # ğŸ’¾ æ ¸å¿ƒåŠŸèƒ½å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ session.py             # ä¼šè¯ç®¡ç†
â”‚   â”‚   â””â”€â”€ èŒè´£: ç®¡ç†AIä»£ç†ä¼šè¯çŠ¶æ€
â”‚   â”‚
â”‚   â””â”€â”€ storage.py             # æ•°æ®å­˜å‚¨
â”‚       â””â”€â”€ èŒè´£: JSONæ–‡ä»¶è¯»å†™ã€æ•°æ®æŒä¹…åŒ–
â”‚
â””â”€â”€ utils/                      # ğŸ› ï¸ å·¥å…·å‡½æ•°å±‚
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ format_utils.py        # æ ¼å¼åŒ–å·¥å…·
    â”‚   â””â”€â”€ èŒè´£: æ•°æ®æ ¼å¼åŒ–ã€æ¶ˆæ¯æ¨¡æ¿
    â”‚
    â””â”€â”€ time_utils.py          # æ—¶é—´å·¥å…·
        â””â”€â”€ èŒè´£: æ—¶é—´æˆ³ç”Ÿæˆã€æ—¶é—´æ ¼å¼åŒ–
```

---

## ğŸ”„ æ•°æ®æµ

### 1. å·¥å…·è°ƒç”¨æµç¨‹

```
IDE (Cursor/Windsurf/Claude)
    â†“
MCP Protocol
    â†“
server_modular.py (è·¯ç”±)
    â†“
tools/*.py (å·¥å…·å®šä¹‰)
    â†“
handlers/*.py (ä¸šåŠ¡é€»è¾‘)
    â†“
core/storage.py (æ•°æ®æŒä¹…åŒ–)
    â†“
JSONæ–‡ä»¶ (mcp_ai_chat/data/)
```

### 2. æ¶ˆæ¯ç³»ç»Ÿæµç¨‹

```
AIä»£ç†A (send_message)
    â†“
message_handler.py
    â”œâ”€> éªŒè¯æ¥æ”¶è€…
    â”œâ”€> ç”Ÿæˆæ¶ˆæ¯ID
    â”œâ”€> æ·»åŠ æ—¶é—´æˆ³
    â””â”€> ä¿å­˜åˆ° messages.json
    
AIä»£ç†B (receive_messages)
    â†“
message_handler.py
    â”œâ”€> è¿‡æ»¤æ¶ˆæ¯ (æ¥æ”¶è€…/æ—¶é—´/å…³é”®è¯)
    â”œâ”€> æ ‡è®°ä¸ºå·²è¯» (å¯é€‰)
    â”œâ”€> æˆªæ–­é•¿æ¶ˆæ¯ (max_content_length)
    â””â”€> è¿”å›æ¶ˆæ¯åˆ—è¡¨
```

### 3. ä»»åŠ¡ç®¡ç†æµç¨‹

```
Manager (create_task)
    â†“
task_handler.py
    â”œâ”€> ç”Ÿæˆä»»åŠ¡ID
    â”œâ”€> éªŒè¯ä¼˜å…ˆçº§ (P0/P1/P2)
    â”œâ”€> è®¾ç½®é»˜è®¤çŠ¶æ€ (å¾…å¼€å§‹)
    â””â”€> ä¿å­˜åˆ° tasks.json

Manager (assign_task)
    â†“
task_handler.py
    â”œâ”€> éªŒè¯ä»»åŠ¡å­˜åœ¨
    â”œâ”€> éªŒè¯æ¥æ”¶è€…å­˜åœ¨
    â”œâ”€> æ›´æ–°ä»»åŠ¡åˆ†é…
    â””â”€> å‘é€é€šçŸ¥æ¶ˆæ¯

Employee (get_tasks)
    â†“
task_handler.py
    â”œâ”€> æ£€æŸ¥æƒé™ (å‘˜å·¥åªèƒ½çœ‹è‡ªå·±çš„)
    â”œâ”€> è¿‡æ»¤ä»»åŠ¡ (åˆ†é…è€…/çŠ¶æ€/ä¼˜å…ˆçº§)
    â””â”€> è¿”å›ä»»åŠ¡åˆ—è¡¨
```

### 4. ç¾¤ç»„åä½œæµç¨‹

```
åˆ›å»ºç¾¤ç»„ (create_group)
    â†“
group_handler.py
    â”œâ”€> ç”Ÿæˆç¾¤ç»„ID
    â”œâ”€> éªŒè¯æˆå‘˜åˆ—è¡¨
    â”œâ”€> åˆ›å»ºç¾¤ç»„è®°å½•
    â””â”€> ä¿å­˜åˆ° groups.json

å‘é€ç¾¤ç»„æ¶ˆæ¯ (send_group_message)
    â†“
group_handler.py
    â”œâ”€> éªŒè¯ç¾¤ç»„å­˜åœ¨
    â”œâ”€> éªŒè¯å‘é€è€…æ˜¯æˆå‘˜
    â”œâ”€> å¤„ç†@æé†’
    â”œâ”€> ç”Ÿæˆæ¶ˆæ¯ID
    â””â”€> ä¿å­˜åˆ° group_messages.json

æ¥æ”¶ç¾¤ç»„æ¶ˆæ¯ (receive_group_messages)
    â†“
group_handler.py
    â”œâ”€> éªŒè¯ç¾¤ç»„å­˜åœ¨
    â”œâ”€> éªŒè¯æ¥æ”¶è€…æ˜¯æˆå‘˜
    â”œâ”€> è¿‡æ»¤æ¶ˆæ¯ (æ—¶é—´/å…³é”®è¯/@æé†’)
    â”œâ”€> ä¼˜å…ˆæ˜¾ç¤ºç½®é¡¶æ¶ˆæ¯
    â””â”€> è¿”å›æ¶ˆæ¯åˆ—è¡¨
```

---

## ğŸ’¾ æ•°æ®å­˜å‚¨

### å­˜å‚¨ä½ç½®

é»˜è®¤å­˜å‚¨åœ¨ `mcp_ai_chat/data/` ç›®å½•ï¼š

```
mcp_ai_chat/data/
â”œâ”€â”€ sessions.json           # AIä»£ç†ä¼šè¯
â”œâ”€â”€ messages.json           # ç‚¹å¯¹ç‚¹æ¶ˆæ¯
â”œâ”€â”€ tasks.json              # ä»»åŠ¡åˆ—è¡¨
â”œâ”€â”€ groups.json             # ç¾¤ç»„ä¿¡æ¯
â”œâ”€â”€ group_messages.json     # ç¾¤ç»„æ¶ˆæ¯
â””â”€â”€ employee_config.json    # å‘˜å·¥é…ç½®
```

### æ•°æ®æ ¼å¼

**ä¼šè¯ (sessions.json)**
```json
{
  "agent_name": {
    "agent_name": "developer",
    "role": "å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
    "description": "è´Ÿè´£UI/UXå¼€å‘",
    "session_id": "SESSION_20251110_123456",
    "created_at": "2025-11-10T12:34:56",
    "last_active": "2025-11-10T12:35:00"
  }
}
```

**æ¶ˆæ¯ (messages.json)**
```json
{
  "messages": [
    {
      "message_id": "MSG_20251110_123456_001",
      "sender": "frontend_dev",
      "recipients": ["backend_dev"],
      "message": "APIå‡†å¤‡å¥½äº†å—ï¼Ÿ",
      "timestamp": "2025-11-10T12:34:56",
      "read_by": [],
      "file_path": null
    }
  ]
}
```

**ä»»åŠ¡ (tasks.json)**
```json
{
  "tasks": [
    {
      "task_id": "TASK_20251110_123456_001",
      "title": "å®ç°ç”¨æˆ·ç™»å½•ç•Œé¢",
      "description": "ä½¿ç”¨Reactåˆ›å»ºå“åº”å¼ç™»å½•è¡¨å•",
      "priority": "P1",
      "status": "è¿›è¡Œä¸­",
      "creator": "manager",
      "assignee": "frontend_dev",
      "created_at": "2025-11-10T12:34:56",
      "due_date": "2025-11-15",
      "is_deleted": false
    }
  ]
}
```

**ç¾¤ç»„ (groups.json)**
```json
{
  "groups": [
    {
      "group_id": "GROUP_20251110_123456_001",
      "name": "å‰ç«¯å¼€å‘ç»„",
      "description": "å‰ç«¯å¼€å‘å›¢é˜Ÿåä½œç¾¤ç»„",
      "members": ["manager", "frontend_dev_1", "frontend_dev_2"],
      "creator": "manager",
      "created_at": "2025-11-10T12:34:56",
      "status": "active"
    }
  ]
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. æ¶ˆæ¯è¿‡æ»¤ä¼˜åŒ–

- **æ—¶é—´è¿‡æ»¤**: ä½¿ç”¨ç´¢å¼•å¿«é€Ÿå®šä½æ—¶é—´èŒƒå›´
- **å…³é”®è¯æœç´¢**: ä½¿ç”¨inæ“ä½œç¬¦ï¼Œé¿å…æ­£åˆ™è¡¨è¾¾å¼
- **æœªè¯»è¿‡æ»¤**: æå‰è¿‡æ»¤ï¼Œå‡å°‘æ•°æ®ä¼ è¾“

### 2. ä»»åŠ¡æƒé™æ§åˆ¶

- **Manager**: ä¸€æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰ä»»åŠ¡
- **Employee**: æå‰è¿‡æ»¤ï¼Œåªè¿”å›åˆ†é…ç»™è‡ªå·±çš„ä»»åŠ¡

### 3. ç¾¤ç»„æ¶ˆæ¯ä¼˜åŒ–

- **åˆ†é¡µåŠ è½½**: é™åˆ¶è¿”å›æ¶ˆæ¯æ•°é‡ï¼ˆé»˜è®¤20æ¡ï¼‰
- **å†…å®¹æˆªæ–­**: è¶…é•¿æ¶ˆæ¯è‡ªåŠ¨æˆªæ–­ï¼ˆé»˜è®¤5000å­—ç¬¦ï¼‰
- **ç½®é¡¶æ¶ˆæ¯**: ç¼“å­˜ç½®é¡¶æ¶ˆæ¯IDï¼Œä¼˜å…ˆè¿”å›

### 4. å¾…å‘½æ¨¡å¼ä¼˜åŒ–

- **å›ºå®š5åˆ†é’Ÿå®šæ—¶å™¨**: é¿å…æ— é™ç­‰å¾…
- **è½®è¯¢æ£€æŸ¥**: æ¯ç§’æ£€æŸ¥ä¸€æ¬¡æ–°ä»»åŠ¡/æ¶ˆæ¯
- **ç«‹å³è¿”å›**: æ”¶åˆ°æ–°ä»»åŠ¡/æ¶ˆæ¯æ—¶ç«‹å³é€€å‡º

---

## ğŸ”’ å®‰å…¨æ€§è€ƒè™‘

### 1. æƒé™æ§åˆ¶

- **ä»»åŠ¡æƒé™**: å‘˜å·¥åªèƒ½æŸ¥çœ‹åˆ†é…ç»™è‡ªå·±çš„ä»»åŠ¡
- **ä»»åŠ¡åˆ é™¤**: åªæœ‰åˆ›å»ºè€…å’Œmanagerå¯ä»¥åˆ é™¤ä»»åŠ¡
- **ç¾¤ç»„æƒé™**: åªæœ‰æˆå‘˜å¯ä»¥å‘é€/æ¥æ”¶ç¾¤ç»„æ¶ˆæ¯

### 2. æ•°æ®éªŒè¯

- **è¾“å…¥éªŒè¯**: æ‰€æœ‰è¾“å…¥å‚æ•°éƒ½è¿›è¡Œç±»å‹å’Œæ ¼å¼éªŒè¯
- **å­˜åœ¨æ€§éªŒè¯**: éªŒè¯å¼•ç”¨çš„å®ä½“ï¼ˆä»£ç†ã€ä»»åŠ¡ã€ç¾¤ç»„ï¼‰æ˜¯å¦å­˜åœ¨
- **çŠ¶æ€éªŒè¯**: éªŒè¯çŠ¶æ€è½¬æ¢æ˜¯å¦åˆæ³•

### 3. é”™è¯¯å¤„ç†

- **ç»Ÿä¸€é”™è¯¯æ ¼å¼**: æ‰€æœ‰é”™è¯¯è¿”å›ç»Ÿä¸€çš„JSONæ ¼å¼
- **é”™è¯¯æ—¥å¿—**: è®°å½•æ‰€æœ‰é”™è¯¯å’Œå¼‚å¸¸
- **å‹å¥½æç¤º**: æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³å»ºè®®

---

## ğŸ”„ å‘åå…¼å®¹æ€§

### åŒæœåŠ¡å™¨æ¨¡å¼

- **server_modular.py**: æ–°ç‰ˆæ¨¡å—åŒ–æœåŠ¡å™¨ï¼ˆæ¨èï¼‰
- **server.py**: æ—§ç‰ˆå•ä½“æœåŠ¡å™¨ï¼ˆå…¼å®¹æ€§ï¼‰

ä¸¤ä¸ªæœåŠ¡å™¨ä½¿ç”¨ç›¸åŒçš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥æ— ç¼åˆ‡æ¢ã€‚

### å·¥å…·æ¥å£ä¿æŒä¸å˜

æ‰€æœ‰28ä¸ªå·¥å…·çš„æ¥å£åœ¨é‡æ„åä¿æŒ100%ä¸å˜ï¼š

```python
# é‡æ„å‰åï¼Œè°ƒç”¨æ–¹å¼å®Œå…¨ç›¸åŒ
register_agent({
  "agent_name": "developer",
  "role": "å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ"
})
```

---

## ğŸ“Š ä»£ç è´¨é‡æŒ‡æ ‡

- **æ€»ä»£ç è¡Œæ•°**: ~16,000è¡Œ
- **æœ€å¤§æ–‡ä»¶è¡Œæ•°**: <820è¡Œ
- **æ¨¡å—æ•°é‡**: 17ä¸ª
- **å·¥å…·æ•°é‡**: 28ä¸ª
- **æµ‹è¯•è¦†ç›–ç‡**: >85%
- **ä»£ç å¤æ‚åº¦**: ä½ï¼ˆMcCabe < 10ï¼‰

---

## ğŸ”® æœªæ¥æ‰©å±•

### è®¡åˆ’ä¸­çš„åŠŸèƒ½

1. **æ•°æ®åº“æ”¯æŒ**: æ›¿æ¢JSONæ–‡ä»¶å­˜å‚¨ä¸ºSQLite/PostgreSQL
2. **Webç•Œé¢**: æä¾›å¯è§†åŒ–ç®¡ç†ç•Œé¢
3. **å®æ—¶é€šçŸ¥**: WebSocketæ¨é€æ–°æ¶ˆæ¯/ä»»åŠ¡
4. **æ–‡ä»¶å­˜å‚¨**: æ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œå…±äº«
5. **æƒé™ç³»ç»Ÿ**: æ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
6. **APIé™æµ**: é˜²æ­¢æ»¥ç”¨å’Œè¿‡è½½

### æ‰©å±•æŒ‡å—

æ·»åŠ æ–°å·¥å…·çš„æ­¥éª¤ï¼š

1. åœ¨ `tools/` ä¸­å®šä¹‰å·¥å…·æ¥å£
2. åœ¨ `handlers/` ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. åœ¨ `server_modular.py` ä¸­æ³¨å†Œå·¥å…·
4. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
5. æ›´æ–°æ–‡æ¡£

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIå‚è€ƒ](API_REFERENCE_CN.md) - æ‰€æœ‰å·¥å…·çš„è¯¦ç»†è¯´æ˜
- [å®‰è£…æŒ‡å—](INSTALLATION_CN.md) - å®‰è£…å’Œé…ç½®æ­¥éª¤
- [ä½¿ç”¨ç¤ºä¾‹](EXAMPLES_CN.md) - å®é™…åº”ç”¨åœºæ™¯
- [æ•…éšœæ’é™¤](TROUBLESHOOTING_CN.md) - å¸¸è§é—®é¢˜è§£å†³

---

## ğŸ’¬ æŠ€æœ¯æ”¯æŒ

å¦‚æœä½ å¯¹æ¶æ„è®¾è®¡æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼š

- ğŸ“§ Email: lhq2328616309@outlook.com
- ğŸ› Issues: https://github.com/KALUSO-nolodjska/ai-team-mcp/issues
- ğŸ’¬ Discussions: https://github.com/KALUSO-nolodjska/ai-team-mcp/discussions

